<!DOCTYPE html>
<html>
<head>
  <title>Simple NFC Reader</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body { font-family: sans-serif; max-width: 600px; margin: auto; padding: 20px; }
    #scanButton { font-size: 1.2em; padding: 10px; cursor: pointer; }
    #output { margin-top: 20px; border: 1px solid #ccc; padding: 10px; min-height: 50px; }
    .error { color: red; }
  </style>
</head>
<body>

  <h1>Web NFC Reader</h1>
  <p>Click the button below and then tap an NFC tag on the back of your Android phone.</p>

  <button id="scanButton">Scan NFC Tag</button>
  <div id="output">
    <p>Waiting for scan...</p>
  </div>
  <div id="error" class="error"></div>

  <script>
    document.getElementById('scanButton').addEventListener('click', async () => {
      const output = document.getElementById('output');
      const errorDiv = document.getElementById('error');
      output.innerHTML = '<p>Waiting for scan...</p>';
      errorDiv.textContent = '';

      if ('NDEFReader' in window) {
        try {
          const ndef = new NDEFReader();
          await ndef.scan();
          output.innerHTML = "<p>Bring an NFC tag close to your device...</p>";

          ndef.addEventListener("reading", ({ message, serialNumber }) => {
            let outputHtml = `> Serial Number: ${serialNumber}<br>`;
            outputHtml += `> Records: (${message.records.length})<br><br>`;

            const decoder = new TextDecoder();
            for (const record of message.records) {
              outputHtml += `<b>Record Type:</b> ${record.recordType}<br>`;
              outputHtml += `<b>MIME Type:</b> ${record.mediaType}<br>`;
              // Assuming the data is text
              outputHtml += `<b>Data:</b> ${decoder.decode(record.data)}<br><hr>`;
            }
            output.innerHTML = outputHtml;
          });

          ndef.addEventListener("readingerror", () => {
            errorDiv.textContent = "Error reading NFC tag.";
          });
        } catch (error) {
          errorDiv.textContent = "NFC Scan failed: " + error;
        }
      } else {
        errorDiv.textContent = "Web NFC is not supported on this browser.";
      }
    });
  </script>

</body>
</html>
